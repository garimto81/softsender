# Build System Documentation

## ğŸ“Œ ê°œìš”

Google Apps Script (GAS) Web App ë°°í¬ë¥¼ ìœ„í•œ Node.js ê¸°ë°˜ ë¹Œë“œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ¯ ì™œ ë¹Œë“œ ì‹œìŠ¤í…œì´ í•„ìš”í•œê°€?

### ë¬¸ì œì 
1. **GAS ëŸ°íƒ€ì„ Includeì˜ ì„±ëŠ¥ ì´ìŠˆ**
   - `<?!= include('file') ?>` ë°©ì‹ì€ ëŸ°íƒ€ì„ì— íŒŒì¼ì„ ë¡œë“œ (ëŠë¦¼)
   - ë°°í¬ ì‹œ ì²´ê° ê°€ëŠ¥í•œ ì„±ëŠ¥ ì €í•˜ ë°œìƒ

2. **ë‹¨ì¼ íŒŒì¼ ê´€ë¦¬ì˜ ì–´ë ¤ì›€**
   - í˜„ì¬ `page.html`: 1,097ì¤„
   - HTML, CSS, JavaScriptê°€ ëª¨ë‘ ì„ì—¬ ìˆìŒ
   - ì½”ë“œ íƒìƒ‰, ìˆ˜ì •, ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€

3. **ì½”ë“œ ì¬ì‚¬ìš©ì„± ë¶€ì¡±**
   - í•¨ìˆ˜ë³„ ëª¨ë“ˆí™” ë¶ˆê°€ëŠ¥
   - í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€

### í•´ê²°ì±…: ë¹Œë“œ íƒ€ì„ ë²ˆë“¤ë§
- **ê°œë°œ ì‹œ**: íŒŒì¼ì„ ëª¨ë“ˆë³„ë¡œ ë¶„ë¦¬í•˜ì—¬ ì‘ì—…
- **ë°°í¬ ì‹œ**: Node.js ìŠ¤í¬ë¦½íŠ¸ë¡œ ë‹¨ì¼ HTML íŒŒì¼ë¡œ ë³‘í•©
- **ê²°ê³¼**: ê°œë°œ ìƒì‚°ì„± â†‘, ë°°í¬ ì„±ëŠ¥ â†‘

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
softsender/
â”œâ”€â”€ src/                           # ê°œë°œ ì†ŒìŠ¤ (ë¶„ë¦¬ëœ íŒŒì¼)
â”‚   â”œâ”€â”€ template.html              # HTML í…œí”Œë¦¿ (ë§ˆí¬ì—…ë§Œ)
â”‚   â”œâ”€â”€ styles.css                 # CSS ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ constants.js               # ìƒìˆ˜ ì •ì˜
â”‚   â”œâ”€â”€ utils.js                   # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”œâ”€â”€ preview.js                 # ë¯¸ë¦¬ë³´ê¸° ë¡œì§
â”‚   â”œâ”€â”€ batch.js                   # ë°°ì¹˜ ì „ì†¡ ê¸°ëŠ¥
â”‚   â”œâ”€â”€ events.js                  # ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
â”‚   â””â”€â”€ init.js                    # ì´ˆê¸°í™” ë¡œì§
â”‚
â”œâ”€â”€ dist/                          # ë¹Œë“œ ì¶œë ¥ (ë°°í¬ìš©)
â”‚   â””â”€â”€ page.html                  # ë³‘í•©ëœ ë‹¨ì¼ íŒŒì¼ â† GASì— ì—…ë¡œë“œ
â”‚
â”œâ”€â”€ build.js                       # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ package.json                   # npm ì„¤ì •
â”œâ”€â”€ softsender_code.gs             # GAS ì„œë²„ ì½”ë“œ (ë³€ê²½ ì—†ìŒ)
â””â”€â”€ docs/
    â”œâ”€â”€ BUILD.md                   # ì´ ë¬¸ì„œ
    â”œâ”€â”€ PRD.md
    â”œâ”€â”€ LLD.md
    â””â”€â”€ FEATURE_ENHANCEMENT_PLAN.md
```

---

## ğŸš€ ì‚¬ìš© ë°©ë²•

### 1. ì´ˆê¸° ì„¤ì • (ìµœì´ˆ 1íšŒ)

```bash
# Node.js íŒ¨í‚¤ì§€ ì„¤ì¹˜
npm install
```

### 2. ê°œë°œ ì›Œí¬í”Œë¡œìš°

#### Option A: ìë™ ë¹Œë“œ (ê¶Œì¥)
```bash
# íŒŒì¼ ë³€ê²½ ê°ì§€ â†’ ìë™ ë¹Œë“œ
npm run dev
```

- `src/` í´ë”ì˜ íŒŒì¼ ìˆ˜ì • â†’ ìë™ìœ¼ë¡œ `dist/page.html` ì¬ìƒì„±
- ê°œë°œí•˜ëŠ” ë™ì•ˆ ê³„ì† ì‹¤í–‰

#### Option B: ìˆ˜ë™ ë¹Œë“œ
```bash
# í•œ ë²ˆë§Œ ë¹Œë“œ
npm run build
```

#### Option C: ë°°í¬ìš© ìµœì í™” ë¹Œë“œ
```bash
# ì£¼ì„ ì œê±° + ì••ì¶•
npm run build:min
```

### 3. ë°°í¬ í”„ë¡œì„¸ìŠ¤

```
1. npm run build:min (ìµœì í™” ë¹Œë“œ)
   â†“
2. dist/page.html ì—´ê¸°
   â†“
3. ì „ì²´ ë‚´ìš© ë³µì‚¬ (Ctrl+A â†’ Ctrl+C)
   â†“
4. Google Apps Script í”„ë¡œì íŠ¸ì˜ page.htmlì— ë¶™ì—¬ë„£ê¸°
   â†“
5. ë°°í¬ â†’ ìƒˆ ë°°í¬ (ë˜ëŠ” ê¸°ì¡´ ë°°í¬ ê´€ë¦¬)
   â†“
6. ì™„ë£Œ âœ…
```

---

## ğŸ“ ì†ŒìŠ¤ íŒŒì¼ ì„¤ëª…

### `src/template.html`
- HTML ë§ˆí¬ì—…ë§Œ í¬í•¨
- ì£¼ì„ìœ¼ë¡œ ì£¼ì… ìœ„ì¹˜ í‘œì‹œ:
```html
<!DOCTYPE html>
<html>
<head>
  <title>Soft Content Sender</title>
  <!-- INJECT:CSS -->
</head>
<body>
  <!-- HTML ë§ˆí¬ì—… -->

  <script>
    // INJECT:CONSTANTS
    // INJECT:UTILS
    // INJECT:PREVIEW
    // INJECT:BATCH
    // INJECT:EVENTS
    // INJECT:INIT
  </script>
</body>
</html>
```

### `src/styles.css`
- ëª¨ë“  CSS ìŠ¤íƒ€ì¼
- `<!-- INJECT:CSS -->` ìœ„ì¹˜ì— `<style>` íƒœê·¸ë¡œ ì£¼ì…

### `src/constants.js`
- `CONSTANTS` ê°ì²´
- ëª¨ë“œ, íƒ€ì…, ë©”ì‹œì§€ ë“± ìƒìˆ˜ ì •ì˜

### `src/utils.js`
- `formatCommas()`, `parseIntClean()`, `formatKM()` ë“±
- ìˆœìˆ˜ í•¨ìˆ˜ë“¤ (ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)

### `src/preview.js`
- `generateCurrentPreview()`, `generatePreview()` ë“±
- ë¯¸ë¦¬ë³´ê¸° ìƒì„± ë¡œì§

### `src/batch.js`
- `addToBatch()`, `sendBatch()`, `renderBatchList()` ë“±
- ë°°ì¹˜ ì „ì†¡ ê¸°ëŠ¥

### `src/events.js`
- `handleModeChange()`, `handleTableChange()` ë“±
- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜

### `src/init.js`
- `initializeApp()`, `initEventDelegation()` ë“±
- ì´ˆê¸°í™” ë¡œì§

---

## âš™ï¸ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ë™ì‘ ì›ë¦¬

### `build.js` í•µì‹¬ ë¡œì§

```javascript
const fs = require('fs');
const path = require('path');

// 1. ì†ŒìŠ¤ íŒŒì¼ ì½ê¸°
const html = fs.readFileSync('src/template.html', 'utf-8');
const css = fs.readFileSync('src/styles.css', 'utf-8');
const constants = fs.readFileSync('src/constants.js', 'utf-8');
// ... ê¸°íƒ€ íŒŒì¼

// 2. í…œí”Œë¦¿ ì¹˜í™˜
const merged = html
  .replace('<!-- INJECT:CSS -->', `<style>${css}</style>`)
  .replace('// INJECT:CONSTANTS', constants)
  .replace('// INJECT:UTILS', utils)
  // ... ê¸°íƒ€ ì£¼ì…

// 3. ë¹Œë“œ ì •ë³´ ì£¼ì„ ì¶”ê°€
const buildInfo = `
<!--
  Build Time: ${new Date().toISOString()}
  Build Version: v10.1
  Auto-generated - DO NOT EDIT THIS FILE DIRECTLY
  Edit source files in src/ and run 'npm run build'
-->
`;

// 4. íŒŒì¼ ì €ì¥
fs.writeFileSync('dist/page.html', buildInfo + merged);
```

---

## ğŸ”§ package.json ìŠ¤í¬ë¦½íŠ¸

```json
{
  "scripts": {
    "dev": "nodemon --watch src --exec \"node build.js\"",
    "build": "node build.js",
    "build:min": "node build.js --minify"
  },
  "devDependencies": {
    "nodemon": "^3.0.0"
  }
}
```

### ìŠ¤í¬ë¦½íŠ¸ ì„¤ëª…
- **dev**: `src/` í´ë” ê°ì‹œ â†’ ë³€ê²½ ì‹œ ìë™ ë¹Œë“œ
- **build**: ì¼ë°˜ ë¹Œë“œ (ì£¼ì„ í¬í•¨)
- **build:min**: ìµœì í™” ë¹Œë“œ (ì£¼ì„ ì œê±°, ì••ì¶•)

---

## ğŸ” ê³ ê¸‰ ê¸°ëŠ¥ (ì„ íƒì‚¬í•­)

### 1. Git Pre-commit Hook
ì»¤ë°‹ ì „ ìë™ ë¹Œë“œ:
```bash
# .git/hooks/pre-commit
#!/bin/sh
npm run build
git add dist/page.html
```

### 2. ì¡°ê±´ë¶€ ì»´íŒŒì¼
```javascript
// src/utils.js
// #if DEBUG
console.log('Debug mode active');
// #endif

// build.jsì—ì„œ --minify ì˜µì…˜ ì‹œ ì œê±°
```

### 3. ë¡œì»¬ ê°œë°œ ì„œë²„
```bash
# ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
npm install -g live-server
live-server dist/
```

---

## ğŸ“Š ë¹Œë“œ ê²°ê³¼ ë¹„êµ

| í•­ëª© | ê¸°ì¡´ (ë‹¨ì¼ íŒŒì¼) | ë¹Œë“œ ì‹œìŠ¤í…œ |
|------|-----------------|------------|
| ê°œë°œ í¸ì˜ì„± | â­â­ | â­â­â­â­â­ |
| ì½”ë“œ íƒìƒ‰ | ì–´ë ¤ì›€ (1097ì¤„) | ì‰¬ì›€ (ëª¨ë“ˆë³„ 50-200ì¤„) |
| ì¬ì‚¬ìš©ì„± | ë‚®ìŒ | ë†’ìŒ (ë…ë¦½ í•¨ìˆ˜) |
| í…ŒìŠ¤íŠ¸ | ë¶ˆê°€ëŠ¥ | ê°€ëŠ¥ (ëª¨ë“ˆë³„ í…ŒìŠ¤íŠ¸) |
| ë°°í¬ ì„±ëŠ¥ | â­â­â­â­â­ | â­â­â­â­â­ (ë™ì¼) |
| ë°°í¬ ì†ë„ | ë¹ ë¦„ | ë¹ ë¦„ (ë¹Œë“œ íƒ€ì„ ë³‘í•©) |

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ë°°í¬ íŒŒì¼ ì§ì ‘ ìˆ˜ì • ê¸ˆì§€
âŒ **ì ˆëŒ€ í•˜ì§€ ë§ˆì„¸ìš”**:
```
dist/page.html ì§ì ‘ ìˆ˜ì •
```

âœ… **ì˜¬ë°”ë¥¸ ë°©ë²•**:
```
1. src/ í´ë”ì˜ í•´ë‹¹ íŒŒì¼ ìˆ˜ì •
2. npm run build ì‹¤í–‰
3. dist/page.html í™•ì¸
```

### 2. GAS ì—…ë¡œë“œ íŒŒì¼
- **ì—…ë¡œë“œí•  íŒŒì¼**: `dist/page.html` (ë¹Œë“œëœ íŒŒì¼)
- **ì—…ë¡œë“œí•˜ì§€ ë§ ê²ƒ**: `src/` í´ë”ì˜ ê°œë³„ íŒŒì¼

### 3. Git ê´€ë¦¬
```gitignore
# .gitignore
node_modules/
dist/page.html    # ë¹Œë“œ ì‚°ì¶œë¬¼ì€ ì œì™¸ (ì„ íƒì‚¬í•­)
```

---

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Q1: `npm run dev` ì‹¤í–‰ ì‹œ ì˜¤ë¥˜
```bash
# nodemon ì„¤ì¹˜ í™•ì¸
npm install nodemon --save-dev
```

### Q2: ë¹Œë“œëœ íŒŒì¼ì— ë³€ê²½ì‚¬í•­ì´ ë°˜ì˜ ì•ˆë¨
```bash
# ìºì‹œ ì‚­ì œ í›„ ì¬ë¹Œë“œ
rm -rf dist/
npm run build
```

### Q3: GASì—ì„œ ë™ì‘ ì•ˆí•¨
- `dist/page.html`ì˜ ë¹Œë“œ ì •ë³´ ì£¼ì„ í™•ì¸
- `<?= ... ?>` íƒœê·¸ ì—†ëŠ”ì§€ í™•ì¸ (ìˆœìˆ˜ HTMLë§Œ)
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ í™•ì¸

---

## ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ

### GAS Include ë°©ì‹ (ê¸°ì¡´, ì‚¬ìš© ì•ˆí•¨)
```html
<?!= include('styles') ?>
<?!= include('scripts') ?>
<!-- ëŸ°íƒ€ì„ ë¡œë“œ â†’ ëŠë¦¼ -->
```

### ë¹Œë“œ ì‹œìŠ¤í…œ (í˜„ì¬)
```html
<style>/* ëª¨ë“  CSSê°€ ì´ë¯¸ ë³‘í•©ë¨ */</style>
<script>/* ëª¨ë“  JSê°€ ì´ë¯¸ ë³‘í•©ë¨ */</script>
<!-- ë¹Œë“œ íƒ€ì„ ë³‘í•© â†’ ë¹ ë¦„ -->
```

**ê²°ê³¼**: ë°°í¬ í›„ ë¡œë”© ì†ë„ ë™ì¼í•˜ê²Œ ë¹ ë¦„ âœ…

---

## ğŸ“ í•™ìŠµ ìë£Œ

### Node.js íŒŒì¼ ì‹œìŠ¤í…œ
- `fs.readFileSync()`: íŒŒì¼ ì½ê¸°
- `fs.writeFileSync()`: íŒŒì¼ ì“°ê¸°
- `path.join()`: ê²½ë¡œ ì¡°í•©

### í…œí”Œë¦¿ ì¹˜í™˜
```javascript
string.replace('placeholder', 'actual content')
```

### Watch ëª¨ë“œ
- `nodemon`: íŒŒì¼ ë³€ê²½ ê°ì§€ ë„êµ¬
- `--watch src`: `src/` í´ë” ê°ì‹œ

---

## ğŸ“… ë²„ì „ íˆìŠ¤í† ë¦¬

- **v1.0** (2025-10-05): ì´ˆê¸° ë¹Œë“œ ì‹œìŠ¤í…œ êµ¬ì¶•
  - ê¸°ë³¸ íŒŒì¼ ë¶„ë¦¬ êµ¬ì¡°
  - ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ êµ¬í˜„
  - Watch ëª¨ë“œ ì§€ì›

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [PRD.md](PRD.md) - ì œí’ˆ ìš”êµ¬ì‚¬í•­
- [LLD.md](LLD.md) - ê¸°ìˆ  ì„¤ê³„
- [README.md](../README.md) - í”„ë¡œì íŠ¸ ê°œìš”

---

**ì‘ì„±ì¼**: 2025-10-05
**ë²„ì „**: v1.0
**ìœ ì§€ë³´ìˆ˜**: ë¹Œë“œ ì‹œìŠ¤í…œ ë³€ê²½ ì‹œ ì´ ë¬¸ì„œ ì—…ë°ì´íŠ¸
